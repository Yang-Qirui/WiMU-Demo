加载embeddings数据: ./output/train_embeddings.pt
Embeddings形状: (462, 128)
阶段: train
样本数量: 462
Embedding维度: 128
计算cosine similarity...
计算欧式距离...
找到归一化参数:
位置范围: [ 95.94747 171.75227]
位置最小值: [-74.38651  -93.490135]
距离已反归一化，使用缩放因子: 133.8499
散点图已保存到: output/embedding_analysis/train_embeddings_all_devices_similarity_distance_scatter.png
相关系数: -0.9721
从embeddings数据中加载了 3 个不同的设备
设备列表: ['355c796ae0f1848f', 'a6c7c51c90f688c9', 'eef974809098607d']
按设备分组完成，共 3 个设备
为每个设备绘制散点图和趋势图...
处理设备: a6c7c51c90f688c9
计算cosine similarity...
计算欧式距离...
散点图已保存到: output/embedding_analysis/device_a6c7c51c90f688c9/train_embeddings_device_a6c7c51c90f688c9_similarity_distance_scatter.png
相关系数: -0.9717
设备 a6c7c51c90f688c9 的散点图已保存到: output/embedding_analysis/device_a6c7c51c90f688c9
设备 a6c7c51c90f688c9 统计信息: 样本数=171, 相似度均值=0.8718, 距离均值=6.8965
处理设备: eef974809098607d
计算cosine similarity...
计算欧式距离...
散点图已保存到: output/embedding_analysis/device_eef974809098607d/train_embeddings_device_eef974809098607d_similarity_distance_scatter.png
相关系数: -0.9724
设备 eef974809098607d 的散点图已保存到: output/embedding_analysis/device_eef974809098607d
设备 eef974809098607d 统计信息: 样本数=141, 相似度均值=0.8466, 距离均值=7.7744
处理设备: 355c796ae0f1848f
计算cosine similarity...
计算欧式距离...
散点图已保存到: output/embedding_analysis/device_355c796ae0f1848f/train_embeddings_device_355c796ae0f1848f_similarity_distance_scatter.png
相关系数: -0.9722
设备 355c796ae0f1848f 的散点图已保存到: output/embedding_analysis/device_355c796ae0f1848f
设备 355c796ae0f1848f 统计信息: 样本数=150, 相似度均值=0.8525, 距离均值=7.5821
为每个设备进行聚类并绘制散点图...
处理设备聚类: a6c7c51c90f688c9
设备 a6c7c51c90f688c9 的聚类散点图已保存到: output/embedding_analysis/device_a6c7c51c90f688c9/train_embeddings_device_a6c7c51c90f688c9_clustering_scatter.png
设备 a6c7c51c90f688c9 聚类统计: 样本数=171, 聚类数=5
设备 a6c7c51c90f688c9 聚类质量: Silhouette=0.6452, Calinski-Harabasz=1044.1023
设备 a6c7c51c90f688c9 聚类内部相似度: 均值=0.9979, 方差=0.0045
设备 a6c7c51c90f688c9 聚类中心间相似度: 均值=0.8082, 方差=0.1391
设备 a6c7c51c90f688c9 各聚类内部相似度详情:
  聚类 0: 均值=0.9980, 方差=0.0024, 样本数=67
  聚类 1: 均值=0.9927, 方差=0.0076, 样本数=14
  聚类 2: 均值=0.9993, 方差=0.0011, 样本数=58
  聚类 3: 均值=0.9884, 方差=0.0115, 样本数=16
  聚类 4: 均值=0.9877, 方差=0.0124, 样本数=16
聚类中心相似度热力图已保存到: output/embedding_analysis/device_a6c7c51c90f688c9/train_embeddings_device_a6c7c51c90f688c9_cluster_centers_heatmap.png
聚类中心相似度矩阵统计:
  最大值: 1.0000
  最小值: 0.5972
  均值: 0.8466
  标准差: 0.1461
  对角线元素（自身相似度）均值: 1.0000
  非对角线元素（不同聚类间相似度）均值: 0.8082
处理设备聚类: eef974809098607d
设备 eef974809098607d 的聚类散点图已保存到: output/embedding_analysis/device_eef974809098607d/train_embeddings_device_eef974809098607d_clustering_scatter.png
设备 eef974809098607d 聚类统计: 样本数=141, 聚类数=5
设备 eef974809098607d 聚类质量: Silhouette=0.5714, Calinski-Harabasz=794.6044
设备 eef974809098607d 聚类内部相似度: 均值=0.9965, 方差=0.0070
设备 eef974809098607d 聚类中心间相似度: 均值=0.8101, 方差=0.1428
设备 eef974809098607d 各聚类内部相似度详情:
  聚类 0: 均值=0.9972, 方差=0.0036, 样本数=36
  聚类 1: 均值=0.9913, 方差=0.0085, 样本数=13
  聚类 2: 均值=0.9876, 方差=0.0120, 样本数=19
  聚类 3: 均值=0.9990, 方差=0.0012, 样本数=54
  聚类 4: 均值=0.9843, 方差=0.0137, 样本数=19
聚类中心相似度热力图已保存到: output/embedding_analysis/device_eef974809098607d/train_embeddings_device_eef974809098607d_cluster_centers_heatmap.png
聚类中心相似度矩阵统计:
  最大值: 1.0000
  最小值: 0.5807
  均值: 0.8481
  标准差: 0.1486
  对角线元素（自身相似度）均值: 1.0000
  非对角线元素（不同聚类间相似度）均值: 0.8101
处理设备聚类: 355c796ae0f1848f
设备 355c796ae0f1848f 的聚类散点图已保存到: output/embedding_analysis/device_355c796ae0f1848f/train_embeddings_device_355c796ae0f1848f_clustering_scatter.png
设备 355c796ae0f1848f 聚类统计: 样本数=150, 聚类数=5
设备 355c796ae0f1848f 聚类质量: Silhouette=0.5908, Calinski-Harabasz=950.0635
设备 355c796ae0f1848f 聚类内部相似度: 均值=0.9972, 方差=0.0060
设备 355c796ae0f1848f 聚类中心间相似度: 均值=0.8092, 方差=0.1424
设备 355c796ae0f1848f 各聚类内部相似度详情:
  聚类 0: 均值=0.9881, 方差=0.0101, 样本数=22
  聚类 1: 均值=0.9985, 方差=0.0018, 样本数=50
  聚类 2: 均值=0.9993, 方差=0.0009, 样本数=48
  聚类 3: 均值=0.9853, 方差=0.0134, 样本数=16
  聚类 4: 均值=0.9916, 方差=0.0077, 样本数=14
聚类中心相似度热力图已保存到: output/embedding_analysis/device_355c796ae0f1848f/train_embeddings_device_355c796ae0f1848f_cluster_centers_heatmap.png
聚类中心相似度矩阵统计:
  最大值: 1.0000
  最小值: 0.5968
  均值: 0.8474
  标准差: 0.1485
  对角线元素（自身相似度）均值: 1.0000
  非对角线元素（不同聚类间相似度）均值: 0.8092
将所有设备的点放在一起进行聚类...
总样本数: 462
设备数量: 3
对坐标进行反归一化:
位置范围: [ 95.94747 171.75227]
位置最小值: [-74.38651  -93.490135]
坐标已反归一化
计算聚类内部余弦相似度...
计算聚类中心之间的余弦相似度...
所有设备聚类散点图已保存到: output/embedding_analysis/train_embeddings_all_devices_clustering_scatter.png
聚类统计: 总样本数=462, 聚类数=5, 设备数=3
聚类质量: Silhouette=0.6143, Calinski-Harabasz=2781.6684
聚类内部相似度: 均值=0.9972, 方差=0.0060
聚类中心间相似度: 均值=0.8109, 方差=0.1395
各聚类内部相似度统计:
  聚类 0: 均值=0.9869, 方差=0.0132, 样本数=54
  聚类 1: 均值=0.9980, 方差=0.0025, 样本数=153
  聚类 2: 均值=0.9876, 方差=0.0120, 样本数=60
  聚类 3: 均值=0.9992, 方差=0.0011, 样本数=160
  聚类 4: 均值=0.9914, 方差=0.0080, 样本数=35
各聚类内部相似度详情（包含设备分布）:
  聚类 0: 均值=0.9869, 方差=0.0132, 样本数=54
    设备分布: {'355c796ae0f1848f': 21, 'a6c7c51c90f688c9': 16, 'eef974809098607d': 17}
  聚类 1: 均值=0.9980, 方差=0.0025, 样本数=153
    设备分布: {'355c796ae0f1848f': 50, 'a6c7c51c90f688c9': 67, 'eef974809098607d': 36}
  聚类 2: 均值=0.9876, 方差=0.0120, 样本数=60
    设备分布: {'355c796ae0f1848f': 23, 'a6c7c51c90f688c9': 16, 'eef974809098607d': 21}
  聚类 3: 均值=0.9992, 方差=0.0011, 样本数=160
    设备分布: {'355c796ae0f1848f': 48, 'a6c7c51c90f688c9': 58, 'eef974809098607d': 54}
  聚类 4: 均值=0.9914, 方差=0.0080, 样本数=35
    设备分布: {'355c796ae0f1848f': 8, 'a6c7c51c90f688c9': 14, 'eef974809098607d': 13}
聚类中心相似度热力图已保存到: output/embedding_analysis/train_embeddings_all_devices_cluster_centers_heatmap.png
聚类中心相似度矩阵统计:
  最大值: 1.0000
  最小值: 0.5990
  均值: 0.8487
  标准差: 0.1459
  对角线元素（自身相似度）均值: 1.0000
  非对角线元素（不同聚类间相似度）均值: 0.8109
绘制所有设备点的散点图...
对坐标进行反归一化:
位置范围: [ 95.94747 171.75227]
位置最小值: [-74.38651  -93.490135]
坐标已反归一化
所有设备散点图已保存到: output/embedding_analysis/train_embeddings_all_devices_scatter.png
设备数量: 3
总样本数: 462
各设备样本统计:
  设备 355c796ae0f1848f: 150 个样本
    坐标范围: X[-73.22, 21.56], Y[-93.49, 78.26]
  设备 a6c7c51c90f688c9: 171 个样本
    坐标范围: X[-74.39, 21.32], Y[-93.39, 53.21]
  设备 eef974809098607d: 141 个样本
    坐标范围: X[-73.04, 21.35], Y[-93.32, 53.70]
统计信息已保存到: output/embedding_analysis/train_embeddings_statistics.json
相似度均值: 0.8574
相似度标准差: 0.1561
距离均值: 990.7873
距离标准差: 726.1520
相似度-距离相关系数: -0.9721
